sudo: false
language: node_js
node_js:
 - "9"
cache:
  directories:
    - "node_modules"
script:
  - npm run lint
  - npm run stylelint
  - npm run build

aliases:
  deploy: &deploy
    provider: heroku
    api_key: 
      secure: "QnSeGTN7k6Cr/uZPCcLDLiHk46QytXYXJMhYjmrzvhWLv5fHDbzraYQ3d055nqBVcKVlHYRlbXytA/OT7hzwy97bPb7pm3/mtQ6YVzFghHpoiK7qBhzFd8SKwxPljf19kGQXtVG72jQ5RVH6GH72nDovS7IgiVrUgXk78QH4AfWfr6lAAMgEKg8Ki3xSmD+HJfk8ra+84PWqN3Oe0Rh0v5ogy7VmOmjaAAAhvuHYAZgwlLC8jZMs73mRZ4H1bjCfa9tR4fghpzLjwFx6jYPnlw6kcoa8VKISVQ846k5W2XboSoWjAcJMy4AWoR4V5JsOZmBUmLr+KYjM7Fpqqwmq+MTLjq7dtTzJdbXqPv76gaMh3lba3PVOFK0eZHMyU2dUlQW5yIjlbcRc9LWCD5A+KkjJSEI4BGDL0+wvZHgQAJ8Efboy83xz2BDKUpYUN/zRQF9DHn7uBdo/7ty7iU/ES9bUP1dREUdoaIIqLCV279ikhljINATPVzw+Jfzo2bJQJBx30lgPQlKVVLMudmcdbzINpPhMJ/tZFQyETXS9lRP14lZpXpE82YYeC8w0PkuGJjncDo9oCnzsy6wLbXScXJVVmdyO5Rlc36PYbxZrpFnSXupqF4vb/FuqPx1tbjmf/3DPLW1Fb8yIkN8KI/DtYDwrVWYYLSyPFu1qkzKFnQU="
    skip_cleanup: true

jobs:
  include:
    - stage: Deploy (development)
      if: tag IS blank
      script:
        - npm run build
      deploy:
        <<: *deploy
        app: yandex-shri-task-456

    - stage: Deploy (production)
      if: tag IS present
      script:
        - npm run build
      deploy:
        <<: *deploy
        app: yandex-shri-task-456
        on:
          tags: true