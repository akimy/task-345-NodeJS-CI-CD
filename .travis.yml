sudo: false
language: node_js
node_js:
 - "9"
cache:
  directories:
    - "node_modules"
script:
  - npm run lint
  - npm run stylelint
  - npm run build

aliases:
  deploy: &deploy
    provider: heroku
    api_key: 
      secure: lcNHYy+m0NgxO39b3A5uj03om79kHd0IzTBgTNDU3fm6bThK+0ThfbFobDC3cRunipUfypiNf4qJpdfM16jdFHBx6Qkz58tEL0OqFmX7gQL3V6WVXS0gjbzHfvGmCx4MJd6+5rT2CEUT8hNzAdLbAzTPe2oGj7VLOhiq85Xnco7xGQp0Ed7i+4WZu4RYlaFrwcfMHUnetZtDsJA4BMPps51hrbk4/ddVBuS8FaCeqae9YXkPwqODNWt8E18pxAcfxicdxqMNdQC7xvpap34WA2oxaUztVheEcYa0m8vE+Xsir7jeSBvMQOy493pBWp3yEIY5/ST74xwGG/g4STUXAKG1YOUcJ+xe/tCDGDRbMp5zz4cEHBOhA+JTTbu8o5OUlVxUWYiHIZaganmekOWUNd8qs5wboW1wbocnXmR0XqosjfcWaQjcKSwY2361HyHe2WQZYU7N2W7DygA+/QpDZCgP/HvaEKBMmU+2HyTe96exheImmKqX0bza5i4DKkfPXFwcCGnAww1AhFjMPBzDbp4UOVNiKW0jKIZmNyLiPGVImVa2ydyktYs0W9ihnImDQ85apHa8Q9S9AKYU6WVOjv5I/i+GwjBqgMEQjl8/FJLtb1pdTrOlPDL8JbaupSFU3b+CLY1szjvXeimOg6uFAtHOgmc0viaYSBDYOrtJzxA=
    skip_cleanup: true

jobs:
  include:
    - stage: Deploy (development)
      if: tag IS blank
      script:
        - npm run build
      deploy:
        <<: *deploy
        app: yandex-shri-task-456

    - stage: Deploy (production)
      if: tag IS present
      script:
        - npm run build
      deploy:
        <<: *deploy
        app: yandex-shri-task-456
        on:
          tags: true